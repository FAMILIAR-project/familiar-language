<div class="code"><pre><span class="c1">// Philippe Merle (ground truth)</span>
<span class="n">PMfm</span> <span class="o">=</span> <span class="kd">FM</span> <span class="o">(</span><span class="n">Frascati</span> <span class="o">:</span> <span class="n">Ar1</span> <span class="n">Ar2</span> <span class="o">[</span><span class="n">Ar3</span><span class="o">]</span> <span class="o">[</span><span class="n">Ar4</span><span class="o">]</span> <span class="o">;</span> <span class="n">Ar1</span> <span class="o">:</span> <span class="o">(</span><span class="n">Ar5</span><span class="o">|</span><span class="n">Ar6</span><span class="o">|</span><span class="n">Ar7</span><span class="o">)+</span> <span class="o">;</span> <span class="n">Ar2</span> <span class="o">:</span> <span class="o">(</span><span class="n">Ar8</span><span class="o">|</span><span class="n">Ar9</span><span class="o">);</span> <span class="n">Ar8</span> <span class="o">-&gt;</span> <span class="n">Ar6</span> <span class="o">;</span> <span class="n">Ar5</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">Ar9</span><span class="o">;</span> <span class="o">)</span>

<span class="c1">// architectural feature model (Arch FM 150%)</span>
<span class="c1">// over approximation</span>
<span class="c1">// notes: ArP8 corresponds to Ar8, ArU5 corresponds to Ar5 (alignment directives needed!)</span>
<span class="n">ARCHfm</span> <span class="o">=</span> <span class="kd">FM</span> <span class="o">(</span><span class="n">Frascati</span> <span class="o">:</span> <span class="n">Ar1</span> <span class="o">[</span><span class="n">Ar2</span><span class="o">]</span> <span class="o">[</span><span class="n">Ar3</span><span class="o">]</span> <span class="o">[</span><span class="n">Ar4</span><span class="o">]</span> <span class="o">;</span> <span class="n">Ar1</span> <span class="o">:</span> <span class="o">(</span><span class="n">ArU5</span><span class="o">|</span><span class="n">Ar6</span><span class="o">|</span><span class="n">Ar7</span><span class="o">)+</span> <span class="o">;</span> <span class="n">Ar2</span> <span class="o">:</span> <span class="o">[</span><span class="n">ArP8</span><span class="o">]</span> <span class="o">[</span><span class="n">Ar9</span><span class="o">];</span> <span class="o">)</span>

<span class="n">PLUGfm</span> <span class="o">=</span> <span class="kd">FM</span> <span class="o">(</span><span class="n">Plugins</span> <span class="o">:</span> <span class="n">Pl1</span> <span class="o">[</span><span class="n">Pl2</span><span class="o">]</span> <span class="o">[</span><span class="n">Pl3</span><span class="o">]</span> <span class="o">[</span><span class="n">Pl4</span><span class="o">]</span> <span class="o">[</span><span class="n">Pl5</span><span class="o">]</span> <span class="n">Pl6</span><span class="o">;</span> <span class="n">Pl6</span> <span class="o">-&gt;</span> <span class="n">Pl3</span><span class="o">;</span> <span class="n">Pl5</span> <span class="o">-&gt;</span> <span class="n">Pl4</span> <span class="o">;</span> <span class="o">)</span>

<span class="n">mappingArchPlug</span> <span class="o">=</span> <span class="kd">constraints</span> <span class="o">(</span><span class="n">Pl3</span> <span class="o">-&gt;</span> <span class="n">Ar2</span> <span class="o">;</span> <span class="n">Pl5</span> <span class="o">-&gt;</span> <span class="n">ArU5</span> <span class="o">;</span> <span class="o">)</span>

<span class="n">ArchPlugfm</span> <span class="o">=</span> <span class="kd">aggregate</span> <span class="o">{</span> <span class="n">ARCHfm</span> <span class="n">PLUGfm</span> <span class="o">}</span> <span class="kd">withMapping</span> <span class="n">mappingArchPlug</span>
<span class="kd">cleanup</span> <span class="n">ArchPlugfm</span> 
<span class="n">ARCHpfm</span> <span class="o">=</span> <span class="kd">extract</span> <span class="n">ArchPlugfm</span><span class="o">.</span><span class="n">Frascati</span>

<span class="c1">// some comparison </span>
<span class="n">cmp</span> <span class="o">=</span> <span class="kd">compare</span> <span class="n">ARCHpfm</span> <span class="n">PMfm</span>
<span class="c1">//merge diff { ARCHpfm PMfm } </span>
</pre></div>
