
\documentclass{article}
\usepackage{fancyvrb}
\usepackage{color}
\usepackage[latin1]{inputenc}


\newcommand\PYZat{@}
\newcommand\PYZlb{[}
\newcommand\PYZrb{]}
\newcommand\PYaJ[1]{\textcolor[rgb]{0.00,0.53,0.00}{\textit{#1}}}
\newcommand\PYaK[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaH[1]{\textcolor[rgb]{1.00,0.00,0.00}{#1}}
\newcommand\PYaI[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaN[1]{\textcolor[rgb]{0.60,0.60,0.60}{#1}}
\newcommand\PYaO[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaL[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaM[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaB[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaC[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaA[1]{\colorbox[rgb]{0.89,0.82,0.82}{\textcolor[rgb]{0.65,0.09,0.09}{#1}}}
\newcommand\PYaF[1]{\textcolor[rgb]{0.00,0.50,0.50}{#1}}
\newcommand\PYaG[1]{\textcolor[rgb]{0.33,0.33,0.33}{#1}}
\newcommand\PYaD[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaE[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaR[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaS[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaP[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaQ[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaj[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYak[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYah[1]{\colorbox[rgb]{1.00,0.87,0.87}{\textcolor[rgb]{0.00,0.00,0.00}{#1}}}
\newcommand\PYai[1]{\textcolor[rgb]{0.00,0.53,0.00}{\textbf{#1}}}
\newcommand\PYan[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYao[1]{\textcolor[rgb]{0.67,0.67,0.67}{#1}}
\newcommand\PYal[1]{\textbf{#1}}
\newcommand\PYam[1]{\textbf{#1}}
\newcommand\PYab[1]{\textit{#1}}
\newcommand\PYac[1]{\textcolor[rgb]{0.50,0.00,0.50}{#1}}
\newcommand\PYaa[1]{\textcolor[rgb]{0.53,0.53,0.53}{#1}}
\newcommand\PYaf[1]{\textcolor[rgb]{0.00,0.53,0.00}{\textit{#1}}}
\newcommand\PYag[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYad[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYae[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaz[1]{\textcolor[rgb]{0.67,0.00,0.00}{#1}}
\newcommand\PYax[1]{\textcolor[rgb]{0.67,0.00,0.00}{#1}}
\newcommand\PYay[1]{\textcolor[rgb]{0.00,0.53,0.00}{\textit{#1}}}
\newcommand\PYar[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYas[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYap[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaq[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYav[1]{\textcolor[rgb]{0.73,0.73,0.73}{#1}}
\newcommand\PYaw[1]{\colorbox[rgb]{0.87,1.00,0.87}{\textcolor[rgb]{0.00,0.00,0.00}{#1}}}
\newcommand\PYat[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYau[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}

\begin{document}

\section*{}

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
@PYaf[// excerpt of the contextual/deployment information]
contextFM = @PYaS[FM] (VSApplicationRequirement: Scene Sort ... ; 
	  			     Scene:  LightingConditions; ... ; 
				     LightingConditions: (Indoors|Outdoors) ... ; ... ;
				     TimeOfDay: (Night|Day) ; 
				     LightingNoise : (Flashes|Shadows|HeadLight) ; )

oContextFM = @PYaS[copy] contextFM

@PYaf[// excerpt of the platform components]
platformFM = @PYaS[FM] (VSPlatform: Segmentation Classification @PYZlb[]LightingAnalyses@PYZrb[]; 
		 Segmentation:  KernelFunction; KernelFunction : AColor KModel ; 
		 AColor : (Color|Grey) ; KModel : (Edge|Region) ;
		 Classification : @PYZlb[]Contour@PYZrb[] @PYZlb[]Density@PYZrb[] @PYZlb[]Model@PYZrb[] ; 
		 LightingAnalyses : @PYZlb[]HeadLightDetect@PYZrb[] ; 
		 Model : @PYZlb[]Omega@PYZrb[] Math ; Math : (ThreeD|Paral|Ellipse);
		 Edge @PYaS[excludes] Density ;)

@PYaf[// constraints relating contextual/deployment features to software features 		 ]
prules = @PYaS[constraints] ( LightingNoise -> (Edge @PYaS[and] LightingAnalyses) ; 
					(Flashes @PYaS[or] HeadLight) -> Contour ; 
					Person -> Omega ; ... ; ) 

@PYaf[// reachability property]
globalFM = @PYaS[aggregate] { contextFM platformFM } @PYaS[withMapping] prules
contextFM2 = @PYaS[slice] globalFM @PYaS[including] globalFM.VSApplicationRequirement*
@PYau[if] (@PYaS[compare] contextFM2 contextFM @PYaS[eq] SPECIALIZATION) @PYaS[then] 
      @PYaS[println] @PYad["For some specifications, there is no software configuration..."] 
      unrContextFM = @PYaS[merge] @PYaS[diff] { contextFM  contextFM2 }    
      @PYaf[// enumeration of unreachable contexts]
      unrContexts = @PYaS[configs] unrContextFM
      @PYaS[println] @PYad["#"] (@PYaS[counting] unrContexts) @PYad[" specifications cannot be reached: "] 
      @PYaS[foreach] (unrContext @PYaS[in] unrContexts) @PYau[do] 
                 @PYaS[println] unrContext
      @PYaS[end]
@PYau[else]
       @PYaS[println] @PYad["For each specification, there exists at least one software configuration"]
@PYaS[end]


@PYaf[// step-wise specialization]
setMandatory contextFM.LightingNoise
@PYaS[removeFeature] contextFM.Shadows
setMandatory contextFM.Outdoors
@PYaS[removeFeature] contextFM.Indoors
@PYaS[removeFeature] contextFM.Vehicle 

@PYaf[// we control that contextFM is a specialization of the original context FM]
@PYau[assert] (@PYaS[compare] contextFM oContextFM @PYaS[eq] SPECIALIZATION)

@PYaf[// now we have specialized the contextual information, let us reason on the integrated FM		]
vsFM = @PYaS[aggregate] { contextFM platformFM } @PYaS[withMapping] prules

@PYaf[// we can propagate some choices in the platform side]
platformFMp = @PYaS[slice] vsFM @PYaS[including] vsFM.VSPlatform*

@PYaf[// we can also propagate some choices in the contextual part]
contextFMp = @PYaS[slice] vsFM @PYaS[including] vsFM.VSApplicationRequirement*
\end{Verbatim}

\end{document}
